# ============================================
# Pre-commit Hook
# 1. .gitignore ê²€ì¦ (ê¸ˆì§€ í´ë” ì²´í¬)
# 2. lint-staged (í¬ë§·íŒ…)
# ============================================

# ğŸš« ë¬´ì‹œí•´ì•¼ í•  í´ë”ê°€ ìŠ¤í…Œì´ì§•ë˜ì—ˆëŠ”ì§€ ì²´í¬
FORBIDDEN_PATHS="docs/ scripts/ logs/ project_context.md"
ERROR_FOUND=false

for path in $FORBIDDEN_PATHS; do
  if git diff --cached --name-only | grep -q "^$path"; then
    echo "âŒ ì˜¤ë¥˜: '$path'ê°€ ì»¤ë°‹ì— í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤!"
    echo "   â†’ .gitignoreë¥¼ í™•ì¸í•˜ê±°ë‚˜, 'git rm --cached' ëª…ë ¹ìœ¼ë¡œ ì œê±°í•˜ì„¸ìš”."
    ERROR_FOUND=true
  fi
done

if [ "$ERROR_FOUND" = true ]; then
  echo ""
  echo "ğŸ’¡ íŒíŠ¸: ì´ë¯¸ ì¶”ì  ì¤‘ì¸ íŒŒì¼ì€ .gitignoreì— ì¶”ê°€í•´ë„ ë¬´ì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
  echo "   â†’ git rm --cached -r <í´ë”ëª…> ìœ¼ë¡œ ì¶”ì ì„ í•´ì œí•˜ì„¸ìš”."
  exit 1
fi

# âœ… Prettier ìë™ í¬ë§·íŒ…
npx lint-staged
